<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>å£è¢‹è¡¥å…‰ç¯ Ultimate</title>
    <style>
        /* --- 1. å…¨å±€é‡ç½® --- */
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body, html { 
            height: 100%; width: 100%; 
            overflow: hidden; /* ç¦æ­¢é¡µé¢æ»šåŠ¨ */
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            background-color: #000; /* å…œåº•èƒŒæ™¯ */
            user-select: none; -webkit-user-select: none; /* ç¦æ­¢é€‰ä¸­æ–‡æœ¬ */
        }

        /* --- 2. å‘å…‰å±‚ (æ ¸å¿ƒ) --- */
        /* é»˜è®¤è®¾ç½®ä¸ºç™½è‰²ï¼Œé˜²æ­¢JSåŠ è½½å¤±è´¥å¯¼è‡´é»‘å± */
        #light-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #ffffff; 
            z-index: 1; 
            transition: background-color 0.2s ease; /* é¢œè‰²åˆ‡æ¢è¿‡æ¸¡ */
        }

        /* è‰²æ¸©é®ç½©å±‚ (å†·æš–è°ƒèŠ‚) */
        #temp-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: transparent;
            z-index: 2;
            pointer-events: none; /* å…è®¸ç‚¹å‡»ç©¿é€ */
            transition: background-color 0.1s linear;
        }

        /* --- 3. UI äº¤äº’å±‚ --- */
        /* å…¨å±ç‚¹å‡»æ„Ÿåº”åŒº (ä»…åœ¨æ²‰æµ¸æ¨¡å¼ä¸‹æœ‰æ•ˆ) */
        #touch-trigger {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 50;
            display: none; /* é»˜è®¤éšè— */
        }

        /* èœå•å®¹å™¨ */
        #menu-container {
            position: fixed; 
            bottom: 40px; 
            left: 50%; 
            transform: translateX(-50%);
            width: 92%; max-width: 420px;
            z-index: 100; /* ä¿è¯åœ¨æœ€ä¸Šå±‚ */
            transition: opacity 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* éšè—åŠ¨ç”»çŠ¶æ€ */
        .ui-hidden {
            opacity: 0;
            transform: translateX(-50%) translateY(40px) scale(0.95) !important;
            pointer-events: none;
        }

        /* ç£¨ç ‚ç»ç’ƒé¢æ¿ */
        .glass-panel {
            background: rgba(20, 20, 20, 0.85);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-radius: 28px;
            padding: 24px 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.1);
            color: white;
        }

        /* --- 4. é¢œè‰²é€‰æ‹©æ  (æ¨ªå‘æ»šåŠ¨) --- */
        .scroll-wrapper {
            display: flex; gap: 12px; overflow-x: auto; 
            padding: 4px; margin: -4px -4px 24px -4px; /* å¢åŠ ç‚¹å‡»åŒºåŸŸ */
            scrollbar-width: none; -ms-overflow-style: none; /* éšè—æ»šåŠ¨æ¡ */
        }
        .scroll-wrapper::-webkit-scrollbar { display: none; }

        .color-dot {
            width: 54px; height: 54px; flex-shrink: 0; 
            border-radius: 14px; 
            cursor: pointer;
            border: 2px solid transparent; /* é€‰ä¸­æ—¶çš„è¾¹æ¡†å ä½ */
            transition: transform 0.1s, border-color 0.2s;
            position: relative;
        }
        .color-dot:active { transform: scale(0.9); }
        .color-dot.active { 
            border-color: #fff; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transform: translateY(-2px);
        }

        /* --- 5. æ»‘åŠ¨æ¡æ ·å¼ --- */
        .control-row { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        .icon { font-size: 20px; width: 24px; text-align: center; opacity: 0.9; }

        /* è‡ªå®šä¹‰ Range Input */
        input[type=range] {
            -webkit-appearance: none; width: 100%; height: 32px; 
            border-radius: 16px; outline: none; margin: 0;
            touch-action: none; /* å…³é”®ï¼šé˜²æ­¢æ‰‹æœºæ»‘åŠ¨é¡µé¢ */
        }

        /* æ»‘å—è½¨é“èƒŒæ™¯ */
        #slider-hue { background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%); }
        #slider-bright { background: linear-gradient(to right, #000, #fff); }
        #slider-temp { background: linear-gradient(to right, #89CFF0, #ffffff, #FFD700); }

        /* æ»‘å—æŒ‰é’® (Thumb) */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; width: 32px; height: 32px; 
            border-radius: 50%; background: #fff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            border: 0.5px solid rgba(0,0,0,0.1);
        }

        /* --- 6. åº•éƒ¨æŒ‰é’® --- */
        .btn-wrapper { text-align: center; margin-top: 15px; }
        .action-btn {
            background: rgba(255,255,255,0.15); color: #fff; border: none;
            padding: 12px 28px; border-radius: 30px; 
            font-size: 15px; font-weight: 600;
            backdrop-filter: blur(10px);
            display: inline-flex; align-items: center; gap: 8px;
        }

        /* æç¤ºè¯­ */
        #tips {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: rgba(255,255,255,0.6); font-size: 16px; pointer-events: none;
            opacity: 0; transition: opacity 0.3s; z-index: 200;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

    </style>
</head>
<body>

    <div id="light-layer"></div> <div id="temp-overlay"></div> <div id="touch-trigger"></div>

    <div id="tips">è½»ç‚¹å±å¹•å”¤èµ·èœå•</div>

    <div id="menu-container">
        <div class="glass-panel">
            
            <div class="scroll-wrapper" id="swatch-list">
                </div>

            <div class="control-row">
                <div class="icon" style="color:#ff6b81">ğŸ¨</div>
                <input type="range" id="slider-hue" min="0" max="360" value="0">
            </div>
            
            <div class="control-row">
                <div class="icon" style="color:#feca57">â˜€ï¸</div>
                <input type="range" id="slider-bright" min="0" max="100" value="100">
            </div>

            <div class="control-row">
                <div class="icon" style="color:#89CFF0">â„ï¸</div>
                <input type="range" id="slider-temp" min="0" max="100" value="50">
                <div class="icon" style="color:#FFD700">ğŸ”¥</div>
            </div>
        </div>

        <div class="btn-wrapper">
            <button class="action-btn" id="btn-fullscreen">
                <span>ğŸ“º è¿›å…¥æ²‰æµ¸æ¨¡å¼</span>
            </button>
        </div>
    </div>

    <script>
        // === 1. æ•°æ®å®šä¹‰ ===
        // é¢„è®¾é¢œè‰²åˆ—è¡¨ (type: 'color' | 'gradient')
        const PRESETS = [
            // è«å…°è¿ªè‰²ç³» (Morandi)
            { h: 350, s: 40, l: 85, name: 'M-Pink' },
            { h: 210, s: 30, l: 75, name: 'M-Blue' },
            { h: 260, s: 25, l: 80, name: 'M-Purple' },
            { h: 45,  s: 60, l: 85, name: 'M-Yellow' },
            { h: 30,  s: 40, l: 85, name: 'M-Beige' },
            // åŸºç¡€ç™½
            { h: 0,   s: 0,  l: 100, name: 'White' },
            // é«˜äº®è‰²ç³» (Brights)
            { h: 120, s: 80, l: 60, name: 'Green' },
            { h: 195, s: 90, l: 60, name: 'SkyBlue' },
            { h: 180, s: 70, l: 75, name: 'Cyan' },
            { h: 270, s: 80, l: 70, name: 'Purple' },
            { h: 300, s: 100, l: 60, name: 'Magenta' },
            { h: 330, s: 100, l: 65, name: 'HotPink' },
            { h: 0,   s: 90, l: 60, name: 'Red' },
            { h: 25,  s: 100, l: 60, name: 'Orange' },
            // ç‰¹æ®Š: è½æ—¥
            { type: 'gradient', name: 'Sunset' } 
        ];

        // çŠ¶æ€ç®¡ç†
        const state = {
            hue: 0,
            sat: 0,
            light: 100,
            temp: 50,
            isGradient: false
        };

        // === 2. DOM å…ƒç´ è·å– ===
        const els = {
            light: document.getElementById('light-layer'),
            tempOverlay: document.getElementById('temp-overlay'),
            menu: document.getElementById('menu-container'),
            trigger: document.getElementById('touch-trigger'),
            tips: document.getElementById('tips'),
            swatchList: document.getElementById('swatch-list'),
            sliderHue: document.getElementById('slider-hue'),
            sliderBright: document.getElementById('slider-bright'),
            sliderTemp: document.getElementById('slider-temp'),
            btnFull: document.getElementById('btn-fullscreen')
        };

        // === 3. åˆå§‹åŒ–é€»è¾‘ ===
        function init() {
            renderSwatches();
            // é»˜è®¤é€‰ä¸­ç™½è‰²
            selectPreset(5); 
            updateRender();
            
            // ç»‘å®šäº‹ä»¶
            bindEvents();
        }

        // æ¸²æŸ“è‰²å—
        function renderSwatches() {
            PRESETS.forEach((p, index) => {
                const dot = document.createElement('div');
                dot.className = 'color-dot';
                dot.dataset.index = index;
                
                // è®¾ç½®è‰²å—é¢„è§ˆè‰²
                if (p.type === 'gradient') {
                    dot.style.background = 'linear-gradient(135deg, #ff9a9e, #fad0c4)';
                } else {
                    dot.style.background = `hsl(${p.h}, ${p.s}%, ${p.l}%)`;
                }
                
                // ç‚¹å‡»äº‹ä»¶
                dot.addEventListener('click', (e) => {
                    // æ»šåŠ¨å±…ä¸­ä¼˜åŒ–
                    e.target.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                    selectPreset(index);
                });

                els.swatchList.appendChild(dot);
            });
        }

        // é€‰ä¸­é¢„è®¾
        function selectPreset(index) {
            const preset = PRESETS[index];
            
            // UI æ›´æ–°: é«˜äº®é€‰ä¸­æ€
            document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
            els.swatchList.children[index].classList.add('active');

            // é€»è¾‘æ›´æ–°
            if (preset.type === 'gradient') {
                state.isGradient = true;
                // æ¸å˜æ¨¡å¼ä¸‹ç¦ç”¨é¢œè‰²æ»‘å—ï¼Œä½†ä¿ç•™äº®åº¦
                disableSlider(els.sliderHue, true);
            } else {
                state.isGradient = false;
                state.hue = preset.h;
                state.sat = preset.s;
                state.light = preset.l;
                
                // åŒæ­¥æ»‘å—ä½ç½®
                els.sliderHue.value = state.hue;
                els.sliderBright.value = state.light;
                disableSlider(els.sliderHue, false);
            }
            updateRender();
        }

        // æ ¸å¿ƒæ¸²æŸ“å‡½æ•°
        function updateRender() {
            // 1. æ¸²æŸ“åº•è‰²
            if (state.isGradient) {
                els.light.style.background = 'linear-gradient(135deg, #ff9a9e 10%, #fad0c4 90%)';
            } else {
                els.light.style.background = `hsl(${state.hue}, ${state.sat}%, ${state.light}%)`;
            }

            // 2. æ¸²æŸ“è‰²æ¸©
            const t = state.temp;
            if (t < 50) {
                // å˜å†· (å åŠ æ·¡è“)
                const opacity = (50 - t) / 50 * 0.5;
                els.tempOverlay.style.background = `rgba(137, 207, 240, ${opacity})`;
            } else if (t > 50) {
                // å˜æš– (å åŠ æ©™é»„)
                const opacity = (t - 50) / 50 * 0.5;
                els.tempOverlay.style.background = `rgba(255, 200, 50, ${opacity})`;
            } else {
                els.tempOverlay.style.background = 'transparent';
            }

            // 3. åŠ¨æ€è°ƒæ•´æç¤ºæ–‡å­—é¢œè‰² (æ·±è‰²èƒŒæ™¯ç”¨ç™½å­—ï¼Œæµ…è‰²èƒŒæ™¯ç”¨é»‘å­—)
            // ç®€å•ä¼°ç®—ï¼šå¦‚æœåœ¨æ¸å˜æ¨¡å¼æˆ–äº®åº¦>60ï¼Œåˆ™è®¤ä¸ºæ˜¯äº®èƒŒæ™¯
            const isLightBg = state.light > 60 || state.isGradient;
            els.tips.style.color = isLightBg ? 'rgba(0,0,0,0.5)' : 'rgba(255,255,255,0.6)';
        }

        // ç»‘å®šæ»‘å—å’ŒæŒ‰é’®äº‹ä»¶
        function bindEvents() {
            // è‰²ç›¸æ‹–åŠ¨
            els.sliderHue.addEventListener('input', (e) => {
                state.hue = parseInt(e.target.value);
                state.sat = 85; // æ‹–åŠ¨æ—¶å¢åŠ é¥±å’Œåº¦
                state.isGradient = false; // é€€å‡ºæ¸å˜æ¨¡å¼
                // ç§»é™¤è‰²å—é€‰ä¸­æ€
                document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
                disableSlider(els.sliderHue, false);
                updateRender();
            });

            // äº®åº¦æ‹–åŠ¨
            els.sliderBright.addEventListener('input', (e) => {
                state.light = parseInt(e.target.value);
                // å¦‚æœåœ¨æ¸å˜æ¨¡å¼ä¸‹åŠ¨äº†äº®åº¦ï¼Œæ˜¯å¦é€€å‡ºï¼Ÿ
                // ç­–ç•¥ï¼šå¦‚æœæ˜¯æ¸å˜æ¨¡å¼ï¼Œäº®åº¦æ»‘å—æš‚æ—¶åªå½±å“ overlay é€æ˜åº¦å¤ªå¤æ‚ï¼Œ
                // ç®€å•èµ·è§ï¼šå¦‚æœåŠ¨äº†äº®åº¦ï¼Œé€€å‡ºæ¸å˜æ¨¡å¼ï¼Œå›åˆ°å½“å‰é¢œè‰²çš„çº¯è‰²æ€
                if (state.isGradient) {
                    state.isGradient = false;
                    state.hue = 350; state.sat = 50; // é‡ç½®ä¸ºé»˜è®¤ç²‰
                    document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
                    disableSlider(els.sliderHue, false);
                }
                updateRender();
            });

            // è‰²æ¸©æ‹–åŠ¨
            els.sliderTemp.addEventListener('input', (e) => {
                state.temp = parseInt(e.target.value);
                updateRender();
            });

            // æ²‰æµ¸æ¨¡å¼åˆ‡æ¢
            els.btnFull.addEventListener('click', toggleImmersive);
            els.trigger.addEventListener('click', toggleImmersive); // ç‚¹å‡»ç©ºç™½å¤„å”¤é†’
        }

        // åˆ‡æ¢æ²‰æµ¸æ¨¡å¼é€»è¾‘
        let isHidden = false;
        function toggleImmersive() {
            isHidden = !isHidden;
            
            if (isHidden) {
                // è¿›å…¥æ²‰æµ¸ï¼šéšè—èœå•ï¼Œæ˜¾ç¤ºå”¤é†’å±‚
                els.menu.classList.add('ui-hidden');
                els.trigger.style.display = 'block'; 
                requestWakeLock();
                enterFullscreen();
                
                // æ˜¾ç¤ºæç¤º3ç§’
                els.tips.style.opacity = 1;
                setTimeout(() => { els.tips.style.opacity = 0; }, 2500);
            } else {
                // é€€å‡ºæ²‰æµ¸ï¼šæ˜¾ç¤ºèœå•ï¼Œéšè—å”¤é†’å±‚
                els.menu.classList.remove('ui-hidden');
                els.trigger.style.display = 'none';
                els.tips.style.opacity = 0;
            }
        }

        // å·¥å…·å‡½æ•°ï¼šç¦ç”¨æ»‘å—æ ·å¼
        function disableSlider(slider, isDisabled) {
            slider.parentElement.style.opacity = isDisabled ? 0.3 : 1;
            // æ³¨æ„ï¼šä¸çœŸæ­£ disabled inputï¼Œå¦åˆ™æ ·å¼ä¼šå¾ˆéš¾çœ‹ï¼Œåªåšè§†è§‰é™çº§
        }

        // å±å¹•å¸¸äº®
        async function requestWakeLock() {
            if ('wakeLock' in navigator) {
                try { await navigator.wakeLock.request('screen'); } 
                catch (err) { console.log('WakeLock skipped'); }
            }
        }

        // å…¨å± API
        function enterFullscreen() {
            const el = document.documentElement;
            if (el.requestFullscreen) el.requestFullscreen();
            else if (el.webkitRequestFullScreen) el.webkitRequestFullScreen();
        }

        // å¯åŠ¨
        init();

    </script>
</body>
</html>