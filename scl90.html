
<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>SCL-90 完整自评问卷</title>
<style>
  :root{
    --bg:#f5f7fa;
    --card:#ffffff;
    --primary:#176f8b;
    --accent:#2aa389;
    --muted:#55606a;
    --success:#1b7a2a;
    --warn:#f39c12;
    --danger:#c62828;
    font-family:"PingFang SC","Microsoft YaHei",Arial,system-ui;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:#0f1720;-webkit-font-smoothing:antialiased}
  .wrap{max-width:980px;margin:20px auto;padding:16px}
  header{display:flex;gap:12px;align-items:center;margin-bottom:10px}
  .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--primary),var(--accent));display:flex;align-items:center;justify-content:center;color:white;font-weight:800;font-size:18px}
  h1{margin:0;font-size:20px}
  p.lead{margin:0;color:var(--muted);font-size:13px}
  .card{background:var(--card);border-radius:12px;padding:16px;box-shadow:0 8px 28px rgba(10,20,25,0.06);border:1px solid rgba(8,16,20,0.03)}
  .qnum{color:var(--muted);margin-bottom:8px}
  .qtext{font-size:18px;font-weight:700;margin-bottom:12px}
  .opts{display:flex;gap:10px;flex-wrap:wrap}
  .opt{flex:1;min-width:120px;padding:14px;border-radius:12px;border:1px solid rgba(8,16,20,0.06);text-align:center;cursor:pointer;background:#fbfeff;transition:all .12s;user-select:none}
  .opt:hover{transform:translateY(-4px);box-shadow:0 8px 20px rgba(10,20,25,0.06)}
  .nav{display:flex;justify-content:space-between;align-items:center;margin-top:14px;gap:8px;flex-wrap:wrap}
  .btn{background:var(--primary);color:#fff;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
  .btn.ghost{background:transparent;border:1px solid rgba(8,16,20,0.06);color:var(--muted)}
  .result{margin-top:14px}
  table{width:100%;border-collapse:collapse;margin-top:14px}
  th,td{border:2px solid #111;padding:14px;text-align:center;vertical-align:middle}
  thead th{background:#fff;font-size:18px}
  td.project{text-align:left;padding-left:24px;font-size:18px}
  .tag{display:inline-block;padding:6px 10px;border-radius:8px;font-weight:700}
  .green{color:var(--success)}
  .orange{color:var(--warn)}
  .red{color:var(--danger)}
  .explain{margin-top:12px;padding:14px;border-radius:8px;background:#fbfeff;border-left:6px solid var(--primary);line-height:1.7}
  footer{margin-top:16px;text-align:center;color:var(--muted);font-size:13px}
  @media (max-width:640px){ .opt{min-width:unset;flex-basis:100%} th,td{padding:10px} }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">SCL90</div>
      <div>
        <h1>SCL-90 完整自评问卷（24小时内可重复测试）</h1>
        <p class="lead">请根据“最近一周”的真实感受作答。每题选择 0–4 分（0=从无，4=非常重），选择后自动显示下一题。完成后显示结果、诊断与详细解释。</p>
      </div>
    </header>

    <div class="card">
      <div id="quizArea">
        <div class="qnum" id="qnum">第 1 / 90 题</div>
        <div class="qtext" id="qtext">题目加载中……</div>
        <div class="opts" id="opts"></div>
        <div class="nav">
          <div style="display:flex;gap:8px;align-items:center">
            <button class="btn ghost" id="prevBtn" onclick="prevQ()" disabled>← 上一题</button>
            <div style="color:var(--muted);font-size:13px">已答 <span id="answeredCount">0</span> / 90</div>
          </div>
          <div>
            <button class="btn" onclick="finishNow()">结束并查看结果</button>
          </div>
        </div>
      </div>

      <div id="resultArea" class="result" style="display:none"></div>
    </div>

    <footer>仅作筛查参考，不能替代临床诊断。若有自伤/伤人念头或严重幻觉等，请立即就医或联系危机干预。</footer>
  </div>

<script>
// 90 道题（中文）
const ITEMS = [
"头痛。",
"神经过敏，心中不踏实。",
"头脑中有不必要的想法或字句盘旋。",
"头晕和昏倒。",
"对异性的兴趣减退。",
"对旁人责备、求全。",
"感到别人能控制您的思想。",
"责怪别人制造麻烦。",
"忘记性大。",
"担心自己的衣饰整齐及仪态的端正。",
"容易烦恼和激动。",
"胸痛。",
"害怕空旷的场所或街道。",
"感到自己的精力下降，活动减慢。",
"想结束自己的生命。",
"听到旁人听不到的声音。",
"发抖。",
"感到大多数人都不可信任。",
"胃口不好。",
"容易哭泣。",
"同异性相处时感到害羞不自在。",
"感到受骗、中了圈套或有人想抓住您。",
"无缘无故地突然感到害怕。",
"自己不能控制地发脾气。",
"怕单独出门。",
"经常责怪自己。",
"腰痛。",
"感到难以完成任务。",
"感到孤独。",
"感到苦闷。",
"过分担忧。",
"对事物不感兴趣。",
"感到害怕。",
"我的感情容易受到伤害。",
"旁人能知道您的私下想法。",
"感到别人不理解您、不同情您。",
"感到人们对您不友好，不喜欢您。",
"做事必须做得很慢以保证做得正确。",
"心跳得很厉害。",
"恶心或胃部不舒服。",
"感到比不上他人。",
"肌肉酸痛。",
"感到有人在监视您、谈论您。",
"难以入睡。",
"做事必须反复检查。",
"难以作出决定。",
"怕乘电车、公共汽车、地铁或火车。",
"呼吸有困难。",
"一阵阵发冷或发热。",
"因为感到害怕而避开某些东西、场合或活动。",
"脑子变空了。",
"身体发麻或刺痛。",
"喉咙有梗塞感。",
"感到没有前途、没有希望。",
"不能集中注意。",
"感到身体的某一部分软弱无力。",
"感到紧张或容易紧张。",
"感到手或脚发重。",
"想到死亡的事。",
"吃得太多。",
"当别人看着您或谈论您时感到不自在。",
"有一些不属于您自己的想法。",
"有想打人或伤害他人的冲动。",
"醒得太早。",
"必须反复洗手、点数目或触摸某些东西。",
"睡得不稳、不深。",
"有想摔坏或破坏东西的冲动。",
"有一些别人没有的想法或念头。",
"感到对别人神经过敏。",
"在商店或电影院等人多的地方感到不自在。",
"感到任何事情都很困难。",
"一阵阵恐惧或惊恐。",
"感到在公共场合吃东西很不舒服。",
"经常与人争论。",
"单独一人时神经很紧张。",
"别人对您的成绩没有作出恰当的评价。",
"即使和别人在一起也感到孤单。",
"感到坐立不安、神经不定。",
"感到自己没有什么价值。",
"感到熟悉的东西变成陌生或不象是真的。",
"大叫或摔东西。",
"害怕会在公共场合昏倒。",
"感到别人想占您的便宜。",
"为一些有关“性”的想法而很苦恼。",
"您认为应该因为自己的过错而受到惩罚。",
"感到要赶快把事情做完。",
"感到自己的身体有严重问题。",
"从未感到和其他人很亲近。",
"感到自己有罪。",
"感到自己的脑子有毛病。"
];

// 因子映射（1-based indices）
const FACTORS = [
  { id:'F1', name:'躯体化', items:[1,4,12,27,40,42,48,49,52,53,56,58] },
  { id:'F2', name:'强迫症状', items:[3,9,10,28,38,45,46,51,55,65] },
  { id:'F3', name:'人际关系敏感', items:[6,21,34,36,37,41,61,69,73] },
  { id:'F4', name:'抑郁', items:[5,14,15,20,22,26,29,30,31,32,54,71,79] },
  { id:'F5', name:'焦虑', items:[2,17,23,33,39,57,72,78,80,86] },
  { id:'F6', name:'敌对', items:[11,24,63,67,74,81] },
  { id:'F7', name:'恐怖/回避', items:[13,25,47,50,70,75,82] },
  { id:'F8', name:'偏执', items:[8,18,43,68,76,83] },
  { id:'F9', name:'精神病性', items:[7,16,35,62,77,84,85,87,88,90] },
  { id:'F10', name:'其他（睡眠/饮食）', items:[19,44,59,60,64,66,89] }
];
FACTORS.forEach(f => f.idx = f.items.map(n => n-1));

// state
let current = 0;
let answers = new Array(ITEMS.length).fill(null);

// DOM refs
const qnumEl = document.getElementById('qnum');
const qtextEl = document.getElementById('qtext');
const optsEl = document.getElementById('opts');
const prevBtn = document.getElementById('prevBtn');
const answeredCountEl = document.getElementById('answeredCount');
const resultArea = document.getElementById('resultArea');

// render a question (single-question view)
function renderQuestion(){
  qnumEl.textContent = `第 ${current+1} / ${ITEMS.length} 题`;
  qtextEl.textContent = `${ITEMS[current]}`;
  optsEl.innerHTML = '';
  // options 0-4 with labels
  const labels = [
    {v:0,t:'0 从无（没有或很少）'},
    {v:1,t:'1 轻度（偶尔）'},
    {v:2,t:'2 中度（有时）'},
    {v:3,t:'3 较重（经常）'},
    {v:4,t:'4 非常重（持续）'}
  ];
  labels.forEach(l=>{
    const d = document.createElement('div');
    d.className = 'opt';
    d.textContent = l.t;
    d.onclick = ()=>{
      answers[current] = l.v;
      updateAnsweredCount();
      // auto-advance after tiny delay to allow click visual response
      setTimeout(()=>{
        if(current < ITEMS.length - 1){
          current++;
          renderQuestion();
        } else {
          finishNow();
        }
      }, 160);
    };
    optsEl.appendChild(d);
  });
  prevBtn.disabled = current === 0;
}

// update answered count display
function updateAnsweredCount(){
  const cnt = answers.filter(v => v!==null).length;
  answeredCountEl.textContent = cnt;
}

// navigation
function prevQ(){ if(current>0){ current--; renderQuestion(); } }
function finishNow(){ showResults(); }

// scoring
function computeScores(arrAnswers){
  const filled = arrAnswers.map(v => (v===null?0:v));
  const total = filled.reduce((s,v)=>s+v,0);
  const gsi = total / ITEMS.length;
  const pst = filled.filter(v=>v>0).length;
  const psdi = pst>0 ? (total / pst) : 0;
  const factorResults = FACTORS.map(f => {
    const vals = f.idx.map(i => filled[i]);
    const sum = vals.reduce((s,v)=>s+v,0);
    const avg = vals.length ? (sum / vals.length) : 0;
    return { id:f.id, name:f.name, sum, avg: Number(avg.toFixed(2)), n: vals.length };
  });
  return { total, gsi: Number(gsi.toFixed(3)), pst, psdi: Number(psdi.toFixed(2)), factorResults };
}

// severity mapping for display
function severityLevel(avg){
  if(avg < 1.5) return { level:'正常', cls:'green' };
  if(avg < 2.0) return { level:'轻度异常', cls:'orange' };
  if(avg < 3.0) return { level:'中度异常', cls:'orange' };
  return { level:'比较严重', cls:'red' };
}

// show results with national norms checks and long explanations
function showResults(){
  // treat unanswered as 0 but warn if many unanswered
  const unanswered = answers.filter(v=>v===null).length;
  if(unanswered > 0){
    if(!confirm(`您还有 ${unanswered} 道题未作答。未作答将按 0（从无）计分。是否继续查看结果？`)) return;
    for(let i=0;i<answers.length;i++) if(answers[i]===null) answers[i]=0;
  }

  const scores = computeScores(answers);
  // national norms: total>160 positive; >250 severe; PST>43; any factor avg>2
  const normFlags = {
    total_over_160: scores.total > 160,
    total_over_250: scores.total > 250,
    pst_over_43: scores.pst > 43,
    any_factor_over_2: scores.factorResults.some(f=>f.avg > 2)
  };

  // render table
  resultArea.style.display = 'block';
  let html = `<div class="card"><h2 style="margin:0 0 12px">测评结果（参考全国常模）</h2>`;
  html += `<div style="margin-bottom:10px;color:var(--muted)"><strong>总分</strong> ${scores.total} ・ <strong>GSI（平均分）</strong> ${scores.gsi.toFixed(3)} ・ <strong>PST（阳性项数）</strong> ${scores.pst} ・ <strong>PSDI</strong> ${scores.psdi}</div>`;

  html += `<table><thead><tr><th style="width:52%">项目</th><th style="width:16%">得分</th><th style="width:16%">均分</th><th style="width:16%">诊断</th></tr></thead><tbody>`;
  scores.factorResults.forEach(f=>{
    const sev = severityLevel(f.avg);
    // diagnosis text color must be red per user; we will use red for 中度/严重, orange for 轻度, green for 正常
    let cls = 'green'; if(sev.level === '轻度异常') cls = 'orange'; if(sev.level === '中度异常' || sev.level === '比较严重') cls = 'red';
    html += `<tr><td class="project">${f.name}</td><td>${f.sum}</td><td>${f.avg.toFixed(2)}</td><td style="color:${cls==='green'? 'var(--success)': (cls==='orange'? 'var(--warn)': 'var(--danger)')}"><strong>${sev.level}</strong></td></tr>`;
  });
  html += `</tbody></table>`;

  // national norms summary placed under table (as image-like text block)
  html += `<div class="explain" style="margin-top:12px"><h3 style="margin-top:0">按全国常模结果，满足以下任一标准，可考虑筛查阳性，需进一步检查：</h3>`;
  html += `<ol><li>总分超过160分；大于250分则比较严重，需要作医学上的详细检查，很可能要做针对性的心理治疗或在医生的指导下服药。</li><li>阳性项目数超过43项；</li><li>任一因子分超过2分。</li></ol>`;
  html += `<h4>因子均分的意义：</h4>`;
  html += `<ul><li>1-2 提示心理健康</li><li>2-3 提示亚健康心理状态</li><li>3-4 提示有心理健康问题</li><li>4-5 提示有严重心理健康问题</li></ul>`;
  html += `</div>`;

  // Add long per-factor explanations (from user's provided text)
  html += `<div class="explain" style="margin-top:12px"><h3 style="margin-top:0">SCL-90 量表 10 个因子解释与说明</h3>`;
  html += `<h4>1. 躯体化：</h4><p>该项目阳性。躯体化主要反映身体不适感，包括心血管、胃肠道、呼吸和其他系统的不适，和头痛、背痛、肌肉酸痛，以及焦虑等躯体不适表现。该分量表均分3分以上，表明个体在身体上有较明显的不适感，并常伴有头痛、肌肉酸痛等症状。均分2分以下，躯体症状表现不明显。总的说来，得分越高，躯体的不适感越强；得分越低，症状体验越不明显。</p>`;
  html += `<h4>2. 强迫症状：</h4><p>该项目阳性。强迫症状主要指那些明知没有必要，但又无法摆脱的无意义的思想、冲动和行为，还有一些比较一般的认知障碍的行为征象也在这一因子中反映。该分量表均分3分以上，强迫症状较明显。均分2分以下，强迫症状不明显。总的说来，得分越高，表明个体越无法摆脱一些无意义的行为、思想和冲动，并可能表现出一些认知障碍的行为征兆。得分越低，表明个体在此种症状上表现越不明显，没有出现强迫行为。</p>`;
  html += `<h4>3. 人际敏感：</h4><p>该项目阳性。人际关系敏感主要是指某些人际的不自在与自卑感，特别是与其他人相比较时更加突出。在人际交往中的自卑感，心神不安，明显的不自在，以及人际交流中的不良自我暗示，消极的期待等是这方面症状的典型原因。该分量表均分3分以上，表明个体人际关系较为敏感，人际交往中自卑感较强，并伴有行为症状（如坐立不安，退缩等）。均分2分以下，表明个体在人际关系上较为正常。总的说来，得分越高，个体在人际交往中表现的问题就越多，自卑、自我中心越突出，并且已表现出消极的期待。得分越低，个体在人际关系上越能应付自如，人际交流自信、胸有成竹，并抱有积极的期待。</p>`;
  html += `<h4>4. 抑郁：</h4><p>该项目阳性。抑郁是以苦闷的情感与心境为代表性症状，还以生活兴趣的减退，动力缺乏，活力丧失等为特征。还表现出失望、悲观以及与抑郁相联系的认知和躯体方面的感受，另外，还包括有关死亡的思想和自杀观念。该分量表均分3分以上，表明个体的抑郁程度较强，生活缺乏足够的兴趣，缺乏运动活力，极端情况下，可能会有想死亡的思想和自杀的观念。均分2分以下，表明个体抑郁程度较弱，生活态度乐观积极，充满活力，心境愉快。总的说来，得分越高，抑郁程度越明显，得分越低，抑郁程度越不明显。</p>`;
  html += `<h4>5. 焦虑：</h4><p>该项目阳性。焦虑一般指那些烦躁，坐立不安，神经过敏，紧张以及由此产生的躯体征象，如震颤等。该分量表均分3分以上，表明个体较易焦虑，易表现出烦躁、不安静和神经过敏，极端时可能导致惊恐发作。均分2分以下，表明个体不易焦虑，易表现出安定的状态。总的说来，得分越高，焦虑表现越明显。得分越低，越不会导致焦虑。</p>`;
  html += `<h4>6. 敌对：</h4><p>该项目阳性。敌对主要从三方面来反映敌对的表现：思想、感情及行为。其项目包括厌烦的感觉，摔物，争论直到不可控制的脾气暴发等各方面。该分量表均分3分以上，表明个体易表现出敌对的思想、情感和行为。均分2分以下，表明个体容易表现出友好的思想、情感和行为。总的说来，得分越高，个体越容易敌对，好争论，脾气难以控制。得分越低，个体的脾气越温和，待人友好，不喜欢争论、无破坏行为。</p>`;
  html += `<h4>7. 恐怖：</h4><p>该项目阳性。恐惧的对象包括出门旅行，空旷场地，人群或公共场所和交通工具。此外，还有社交恐怖。该分量表均分3分以上，表明个体恐怖症状较为明显，常表现出社交、广场和人群恐惧。均分2分以下，表明个体的恐怖症状不明显。总的说来，得分越高，个体越容易对一些场所和物体发生恐惧，并伴有明显的躯体症状。得分越低，个体越不易产生恐怖心理，越能正常的交往和活动。</p>`;
  html += `<h4>8. 偏执：</h4><p>该项目阳性。偏执主要指投射性思维，敌对，猜疑，妄想，被动体验和夸大等。该分量表均分3分以上，表明个体的偏执症状明显，较易猜疑和敌对。均分2分以下，表明个体的偏执症状不明显。总的说来，得分越高，个体越易偏执，表现出投射性的思维和妄想，得分越低，个体思维越不易走极端。</p>`;
  html += `<h4>9. 精神病性：</h4><p>该项目阳性。精神病性反映各式各样的急性症状和行为，即限定不严的精神病性过程的症状表现，例如幻听、思维离散，被控制感，思维被插入等放映精神分裂症状项目。该分量表均分3分以上，表明个体的精神病性症状较为明显。均分2分以下，表明个体的精神病性症状不明显。总的说来，得分越高，越多的表现出精神病性症状和行为。得分越低，就越少表现出这些症状和行为。</p>`;
  html += `<h4>10. 其他（睡眠/饮食等）：</h4><p>作为附加项目，结果仅作为参考。睡眠与饮食问题常与情绪障碍相伴，应结合整体临床表现评估。</p>`;
  html += `</div>`;

  // national flags summary
  html += `<div class="explain" style="margin-top:12px"><h3 style="margin-top:0">全国常模警示（若满足任一项，建议进一步评估）</h3><ul>`;
  html += `<li>总分超过 160 分；大于 250 分 则比较严重（需要医学详细检查、可能需心理治疗或在医生指导下服药）。</li>`;
  html += `<li>阳性项数（评分 > 0 的题数）超过 43 项。</li>`;
  html += `<li>任一因子均分超过 2 分。</li>`;
  html += `</ul>`;
  html += `<p><strong>当前检测是否触及常模警示：</strong> `;
  const warnings = [];
  if(normFlags.total_over_160) warnings.push('总分>160');
  if(normFlags.total_over_250) warnings.push('总分>250（较严重）');
  if(normFlags.pst_over_43) warnings.push('阳性项数>43');
  if(normFlags.any_factor_over_2) warnings.push('任一因子均分>2');
  html += warnings.length ? warnings.join('；') : '未触及上述常模警示条件（未发现明显筛查阳性）';
  html += `</p></div>`;

  // provide tailored next-step suggestions based on conditions
  html += `<div class="explain" style="margin-top:12px"><h3 style="margin-top:0">基于当前结果的操作建议（详细）</h3>`;
  if(normFlags.total_over_250){
    html += `<p style="color:var(--danger)"><strong>重要提示：</strong>总分超过 250 分，提示总体症状较重或可能有较明显的心理障碍，建议尽快进行医学与心理专业评估。可联系精神科或心理科门诊进行全面评估（包括躯体检查、心理评估与必要的实验室检查）。在专业指导下，可能需要联合心理治疗和药物干预。</p>`;
  } else if(normFlags.total_over_160 || normFlags.pst_over_43 || normFlags.any_factor_over_2){
    html += `<p style="color:var(--warn)"><strong>提醒：</strong>检测结果提示存在筛查阳性风险，建议预约心理或精神卫生专业人员进一步评估，以明确诊断并制定干预计划。可先尝试以下步骤：</p>`;
    html += `<ol><li>与全科或心理门诊预约进行面谈评估，说明本次量表结果，并提供具体的症状史。</li><li>如伴随睡眠明显紊乱、食欲改变、社交功能下降或自伤念头，优先安排面对面或远程评估。</li><li>专业评估后，可依据问题性质选择心理治疗（CBT、ERP、暴露疗法、人际治疗等）或药物治疗。</li></ol>`;
  } else {
    html += `<p><strong>结论：</strong>暂未触及全国常模的筛查阳性标准。建议继续保持良好生活方式（充足睡眠、规律运动、社交支持），如出现持续性或加重的症状，再寻求专业评估。</p>`;
  }
  html += `<p style="margin-top:8px"><strong>若您有下列任一情况，请立即就医或联系危机干预：</strong></p>`;
  html += `<ul><li>出现自伤或自杀念头、或担心自己会伤害他人；</li><li>出现明显的幻觉或意识混乱；</li><li>严重失眠导致无法正常工作或照顾自己；</li><li>情绪或行为波动导致严重人际或法律/安全问题。</li></ul>`;
  html += `</div>`;

  // finish card
  html += `</div>`;

  // append to result area
  resultArea.innerHTML = html;
  resultArea.scrollIntoView({behavior:'smooth'});

  // also console log a concise summary
  console.log('scores', scores, 'normFlags', normFlags);
}

// download/export
function downloadReport(){
  const scores = computeScores(answers);
  const payload = { generatedAt: new Date().toISOString(), answers, scores, items: ITEMS, factors: FACTORS };
  const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(payload,null,2));
  const a = document.createElement('a'); a.href = dataStr;
  a.download = 'scl90_report_' + (new Date().toISOString().slice(0,19).replace(/[:T]/g,'-')) + '.json';
  a.click();
}

// initialize
renderQuestion();
updateAnsweredCount();
</script>
</body>
</html>
